try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{})["__faroBundleId_gptengineer-app"]="17618321824302d6d31c39f"}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3851],{680:(e,t,r)=>{r.d(t,{x:()=>a});var a=function(e){return e.LaunchpadExamplePrompts="launchpad-example-prompts",e.InAppTeaching="in-app-teaching",e.MemoryIntegration="memory-integration",e.IntegrationConnection="integration-connect",e.ModelSelector="quartz-toggle",e.AIGateway="ai-gateway",e.Embed="embed",e.ChatSuggestions="chat-suggestions",e.SetCreditLimit="set-credit-limit",e.DownloadZip="download-zip",e.McpPlugins="mcp-plugins",e.DashboardV2="dashboard-v2",e.EnableRemixWithSupabase="enable-remix-with-supabase",e.UsageBasedBilling="usage-based-billing",e.AutoTopup="auto-topup",e.ThemeSelectorTool="pensive-cat",e.RLSManager="rls-manager",e.NewReverts="new-reverts",e.VisualEdit3="visual-edits-3",e.UnifiedSupabaseProjectCreation="unified-supabase-project-creation",e.GrowthXContent="growthx-content",e.ProjectProfiles="project-profiles",e.RemixSecrets="remix-secrets",e.CustomDomainsV2="custom-domains-v2",e.ChatFullscreen="chat-fullscreen",e.ProjectAccessRequests="project-access-request",e.QuestionsTool="questions-tool",e.DesignPanel="design-panel",e.DesignLibraries="design-libraries",e.GkeApiUrl="gke-api-url",e.EnableBackupsInRevert="enable-backups-in-revert",e}({})},6835:(e,t,r)=>{r.d(t,{C5:()=>c,W_:()=>u,tu:()=>d});var a=r(24178),s=r(31088),n=r(19620);let i={"auth/email-already-in-use":"errors.emailAlreadyInUse","auth/too-many-requests":"errors.tooManyRequests","auth/invalid-login-credentials":"errors.invalidLoginCredentials","auth/popup-blocked":"errors.popupBlocked","auth/operation-not-allowed":"errors.operationNotAllowed","auth/account-exists-with-different-credential":"errors.accountExistsWithDifferentCredential","auth/invalid-credential":"errors.invalidCredential","auth/missing-password":"errors.missingPassword","auth/user-cancelled":"errors.userCancelled","auth/popup-closed-by-user":"errors.popupClosedByUser","auth/requires-recent-login":"errors.requiresRecentLogin","auth/user-mismatch":"errors.userMismatch","auth/invalid-verification-code":"errors.invalidVerificationCode","auth/invalid-verification-id":"errors.invalidVerificationId","auth/credential-already-in-use":"errors.credentialAlreadyInUse","auth/weak-password":"errors.weakPassword","auth/wrong-password":"errors.wrongPassword","auth/user-not-found":"errors.userNotFound","auth/network-request-failed":"errors.networkRequestFailed","auth/internal-error":"errors.internalError","auth/invalid-api-key":"errors.invalidApiKey","auth/app-deleted":"errors.appDeleted","auth/user-disabled":"errors.userDisabled","auth/user-token-expired":"errors.userTokenExpired","auth/web-storage-unsupported":"errors.webStorageUnsupported","auth/invalid-email":"errors.invalidEmail","auth/cancelled-popup-request":"errors.cancelledPopupRequest","auth/unauthorized-domain":"errors.unauthorizedDomain","auth/error-code:-47":"errors.errorCode47"};function o(e){let t=e;return(t=(t=(t=t.replace(/^Firebase:\s*/i,"")).replace(/\s*\(auth\/[\w-]+\)\.?$/i,"")).replace(/^auth\/[\w-]+\s*:\s*/i,"")).trim()}function l(e,t){let r=e.toLowerCase(),a=[];if((r.includes("at least 8 characters")||r.includes("8 characters"))&&a.push(t?t("errors.atLeast8Characters"):"at least 8 characters"),(r.includes("numeric character")||r.includes("number"))&&a.push(t?t("errors.aNumber"):"a number (0-9)"),(r.includes("non-alphanumeric character")||r.includes("special character"))&&a.push(t?t("errors.aSpecialCharacter"):"a special character (like !, @, #, $, etc.)"),(r.includes("uppercase letter")||r.includes("uppercase"))&&a.push(t?t("errors.anUppercaseLetter"):"an uppercase letter (A-Z)"),(r.includes("lowercase letter")||r.includes("lowercase"))&&a.push(t?t("errors.aLowercaseLetter"):"a lowercase letter (a-z)"),a.length>0){let e=t?t("errors.passwordMustContain"):"Password must contain";if(1===a.length)return"".concat(e," ").concat(a[0]);{if(2===a.length)return"".concat(e," ").concat(a[0]," and ").concat(a[1]);let t=a.pop(),r=a.join(", ");return"".concat(e," ").concat(r,", and ").concat(t)}}return t?t("errors.passwordValidationFailed"):"Password validation has failed. Try using a password with at least 8 characters and one number (0-9)."}function c(e,t){var r,a;if(null==e?void 0:e.error){let t=e.error;if(t.message)return o(t.message);if(t.errors&&Array.isArray(t.errors)&&t.errors.length>0)return o(t.errors[0].message||"SSO authentication failed")}if(null==e||null==(r=e.customData)?void 0:r.error){let t=e.customData.error;if(t.message)return o(t.message);if(t.errors&&Array.isArray(t.errors)&&t.errors.length>0)return o(t.errors[0].message||"SSO authentication failed")}if("auth/weak-password"===e.code||"auth/weak_password"===e.code)return l(e.message||"",t);let s=e.message||"";if(s.includes("Missing password requirements")||s.includes("Password must contain")||s.includes("password requirements"))return l(s,t);let c=i[e.code];if(c){if(t)try{let r=null==(a=e.customData)?void 0:a.email;return r?t(c,{email:r}):t(c)}catch(e){n.logging.warn("Failed to translate auth error message",{error:e,translationKey:c})}let r="string"==typeof e.code?e.code:"";if(r){let e=r.replace(/^auth\//i,"").replace(/[-_]+/g," ");return e.charAt(0).toUpperCase()+e.slice(1)}return"Authentication error"}return o(e.message||"Authentication failed")}function u(e){return["auth/user-cancelled","auth/popup-closed-by-user","auth/cancelled-popup-request"].includes(e)}function d(e){let{error:t,title:r,description:n,onComplete:i,toastDuration:o=8e3,translate:l}=e,d=n;if(t instanceof a.g)if(u(t.code)){null==i||i();return}else d=c(t,l),t.code;else t instanceof Error?(t.code||t.error||t.customData)&&(d=c(t,l),t.code):t&&"object"==typeof t&&(d=c(t,l),t.code);s.toast.error(r,{description:d,duration:o}),null==i||i()}},19620:(e,t,r)=>{r.r(t),r.d(t,{asyncSpan:()=>v,logging:()=>w,syncSpan:()=>y,tracer:()=>p,useLoggingStore:()=>f,wrapAsyncWithSpan:()=>E,wrapSyncWithSpan:()=>b});var a=r(96477),s=r(35635),n=r(58324),i=r(50262),o=r(95018),l=r(84510);r(24500),r(86349);var c=r(85454);let u={[c.$.LOG]:5,[c.$.TRACE]:4,[c.$.DEBUG]:3,[c.$.INFO]:2,[c.$.WARN]:1,[c.$.ERROR]:0},d=c.$.LOG;function p(){return a.u.getTracer("gptengineer-app")}class h{static generateSessionId(){return(0,o.A)()}setSession(e){this._session={session_id:h.generateSessionId(),previous_session:this._session.session_id,project_id:e}}setUser(e){this._user=e}get session(){return this._session}get user(){return this._user}sessionForLogging(){let{session_id:e,...t}=this._session;return{session_id:e,...Object.fromEntries(Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["session_attrs_".concat(t),r]}))}}userForLogging(){return Object.fromEntries(Object.entries(this._user||{}).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["user_".concat(t),r]}))}getForLogging(){return Object.fromEntries(Object.entries({...this.sessionForLogging(),...this.userForLogging()}).filter(e=>{let[t,r]=e;return void 0!==r}))}constructor(){this._session={session_id:h.generateSessionId()}}}let g=new h,f=(0,l.vt)(e=>({metadata:g,setMetadata:t=>e({metadata:t})}));function m(e,t){if(!(u[e]>u[d]))switch(e){case c.$.INFO:console.info(...t);break;case c.$.DEBUG:console.debug(...t);break;case c.$.TRACE:console.trace(...t);break;case c.$.WARN:console.warn(...t);break;case c.$.ERROR:console.error(...t);break;case c.$.LOG:console.log(...t)}}let w={info:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.INFO,t)},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.DEBUG,t)},trace:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.TRACE,t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.WARN,t)},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.ERROR,t)},log:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m(c.$.LOG,t)}};async function v(e,t,r,o){var l;let c=null!=(l=null==o?void 0:o.tracer)?l:p();if((null==o?void 0:o.requireParent)&&!a.u.getActiveSpan())return await Promise.resolve(r(null));let u=c.startSpan(e,{kind:s.v.INTERNAL,...t});try{let e=a.u.setSpan(n._.active(),u);return await n._.with(e,()=>Promise.resolve(r(u)))}catch(t){let e=t instanceof Error?t:Error(String(t));throw u.setStatus({code:i.s.ERROR,message:e.message}),u.recordException(e),t}finally{u.end()}}function y(e,t,r,o){var l;let c=null!=(l=null==o?void 0:o.tracer)?l:p();if((null==o?void 0:o.requireParent)&&!a.u.getActiveSpan())return r(null);let u=c.startSpan(e,{kind:s.v.INTERNAL,...t});try{let e=a.u.setSpan(n._.active(),u);return n._.with(e,()=>r(u))}catch(t){let e=t instanceof Error?t:Error(String(t));throw u.setStatus({code:i.s.ERROR,message:e.message}),u.recordException(e),t}finally{u.end()}}function E(e,t,r,a){return function(){for(var s=arguments.length,n=Array(s),i=0;i<s;i++)n[i]=arguments[i];return v(e,t,()=>Promise.resolve(r.apply(this,n)),a)}}function b(e,t,r,a){return function(){for(var s=arguments.length,n=Array(s),i=0;i<s;i++)n[i]=arguments[i];return y(e,t,()=>r.apply(this,n),a)}}},24500:(e,t,r)=>{r.d(t,{L:()=>a});class a extends Error{constructor(e,t,r,a,s){super(t),this.type=e,this.details=r,this.status=a,this.traceId=s}}},29260:(e,t,r)=>{r.d(t,{authEvents:()=>n});var a=r(92998);class s extends a.EventEmitter{emitAuthError(e){this.emit("auth:error",{pathname:e})}}let n=new s},35418:(e,t,r)=>{r.d(t,{auth:()=>d,O:()=>p,db:()=>u,n:()=>g});var a=r(75698),s=r(17479),n=r(19620),i=r(24178),o=r(51144),l=r(81496),c=r(77817);let{db:u,auth:d,database:p}=(()=>{let e=(0,i.Wp)(c.C),t=(0,l._A)(e,{experimentalForceLongPolling:!0}),r=(0,a.xI)(e),s=(0,o.C3)(e);return{app:e,db:t,auth:r,database:s}})(),h=!1,g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!h&&t&&e){h=!0;let t=await (0,s.HD)({serverCustomToken:e,refreshTokenUrl:"/api/refresh-token"});if(!t)return h=!1,n.logging.error("No custom token found in initialize()"),{db:u,auth:d};try{await (0,a.p)(d,t)}catch(e){n.logging.error("Unable to sign-in with custom-token in firebase initialization: ".concat(e)),h=!1}}return{db:u,auth:d,database:p}}},41621:(e,t,r)=>{r.d(t,{Ac:()=>v,DU:()=>m,Kd:()=>u,T3:()=>g,WS:()=>h,dA:()=>l,fJ:()=>c,m9:()=>f,xz:()=>y,z9:()=>w});var a=r(75698),s=r(84510),n=r(6835),i=r(35418),o=r(19620);let l=(0,s.vt)(e=>({active:!1,message:void 0,providers:[],workspace:null,activate:t=>{let{message:r,providers:a,workspace:s}=t;return e({active:!0,message:r,providers:a,workspace:s})},deactivate:()=>e({active:!1,message:void 0,providers:[],workspace:null})}));function c(e){let{active:t}=l.getState();if(!t){l.getState().activate(e);{let{pathname:e,search:t,hash:a}=window.location;if("/sso/reauth"!==e){let s=encodeURIComponent("".concat(e).concat(t).concat(a));r.e(3410).then(r.bind(r,13410)).then(e=>{let{redirect:t}=e;return t("/sso/reauth?redirectTo=".concat(s))})}}}}let u="auth-redirecting";function d(){try{let{pathname:e,search:t,hash:r}=window.location,a=new URLSearchParams(t);a.set(u,String(Date.now()));let s="".concat(e,"?").concat(a.toString()).concat(r);window.history.replaceState({},document.title,s)}catch(e){}}async function p(e){let{workspaceId:t,queryClient:a,onComplete:s,shouldRefreshPage:n=!1}=e,{workspaceKeys:l}=await Promise.resolve().then(r.bind(r,69850)),{toast:c}=await Promise.resolve().then(r.bind(r,31088));try{i.auth.currentUser&&await i.auth.currentUser.getIdToken(!0),await a.invalidateQueries({queryKey:l.all}),c.success("Re-authentication successful",{description:"You can now access the workspace."}),n&&window.location.reload(),null==s||s()}catch(e){throw o.logging.error("reauth_token_refresh_failed",{error:e,workspaceId:t}),c.error("Re-authentication failed",{description:"Please try again or contact support."}),e}}async function h(e){let{auth:t,user:r,providerId:s,authType:n,onSuccess:l,onError:c,logContext:u={}}=e;try{let e,c=t||i.auth,p=new a.LD(s),h=function(){let e="localhost"===window.location.hostname,t=window.navigator.userAgent,r=t.includes("Safari")&&!t.includes("Chrome");return e||r}();if(o.logging.info("Starting SSO ".concat(n),{provider:s,usePopup:h,userId:(null==r?void 0:r.uid)||"anonymous",...u}),h){switch(n){case"signin":e=await (0,a.df)(c,p);break;case"reauth":if(!r)throw{code:"auth/missing-user",message:"User required for reauthentication"};e=await (0,a.Bm)(r,p),await e.user.getIdToken(!0),await e.user.getIdTokenResult(!0);break;case"link":if(!r)throw{code:"auth/missing-user",message:"User required for linking"};e=await (0,a.x8)(r,p)}await l(e)}else switch(n){case"signin":d(),await (0,a.$2)(c,p);break;case"reauth":if(!r)throw{code:"auth/missing-user",message:"User required for reauthentication"};d(),await (0,a.zT)(r,p);break;case"link":if(!r)throw{code:"auth/missing-user",message:"User required for linking"};d(),await (0,a.dC)(r,p)}}catch(e){c(e,"sso ".concat(n))}}function g(e,t){return!!e&&e.providerData.some(e=>e.providerId===t)}function f(e){let{workspaceId:t,queryClient:r,onSuccess:a,shouldRefreshPage:s=!1,setIsLoading:i}=e;return{handleReauthSuccess:async()=>{try{await p({workspaceId:t,queryClient:r,onComplete:a,shouldRefreshPage:s})}finally{i(!1)}},handleReauthError:(e,r,a)=>{(0,n.tu)({error:e,context:r,title:"Re-authentication failed",description:"Please try again or contact support.",workspaceId:t,providerId:a,onComplete:()=>i(!1)})}}}let m=(e,t,r)=>{let a=e||t[0]||"";if(!a)return r;let s=a.split(".")[0];return s.charAt(0).toUpperCase()+s.slice(1)},w=e=>e.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),v=e=>!!e&&/^[a-z0-9]+(?:-[a-z0-9]+)*$/.test(e),y=()=>"".concat(window.location.origin,"/sso-login/")},53861:(e,t,r)=>{r.d(t,{tokenManager:()=>p});var a=r(59070),s=r(61535);class n{get(e){return this.cacheMap[e]?this.cacheMap[e]:e}set(e,t){this.cacheMap={[e]:t}}constructor(){this.cacheMap={}}}let i=new n;async function o(e){var t;let{serverIdToken:r,refreshTokenUrl:n,checkRevoked:o}=e;if(!r)return null;let l=i.get(r),c=(0,a.i)(l),d=null!=(t=null==c?void 0:c.exp)?t:0,p=Date.now()/1e3;if(!o&&p+300<d)return l;let h=await u(n);if(!(null==h?void 0:h.idToken))throw new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"Refresh token endpoint returned invalid response. This URL should point to endpoint exposed by the middleware and configured using refreshTokenPath option");return i.set(r,h.idToken),h.idToken}async function l(e,t,r){var a;let n=await c(e);return new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"next-firebase-auth-edge: Internal request to ".concat(null!=(a=null==r?void 0:r.method)?a:"GET"," ").concat(t.toString()," has failed: ").concat(n))}function c(e){let t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")?e.json():e.text()}async function u(e,t){let r=await fetch(e,{...t,headers:{...null==t?void 0:t.headers,Accept:"application/json","Content-Type":"application/json"}});if(!r.ok)throw await l(r,e,t);return c(r)}class d{setServerIdToken(e){this.serverIdToken=e,this.initialized=!0}isInitialized(){return this.initialized}async getValidToken(){if(!this.serverIdToken)return null;if(this.refreshPromise)return this.refreshPromise;try{this.refreshPromise=o({serverIdToken:this.serverIdToken,refreshTokenUrl:"/api/refresh-token"});let e=await this.refreshPromise;return this.refreshPromise=null,e}catch(e){return this.refreshPromise=null,null}}constructor(){this.serverIdToken=null,this.refreshPromise=null,this.initialized=!1}}let p=new d},54994:(e,t,r)=>{r.d(t,{G:()=>o,queryClient:()=>i});var a=r(77145),s=r(41757),n=r(87299);let i=new s.E,o=e=>{let{children:t}=e;return(0,a.jsx)(n.Ht,{client:i,children:t})}},56455:(e,t,r)=>{r.d(t,{dA:()=>a.dA,fJ:()=>a.fJ}),r(6835);var a=r(41621)},63851:(e,t,r)=>{r.r(t),r.d(t,{getGoApi:()=>_,getUnauthenticatedGoApi:()=>S});var a=r(82694),s=r(54994),n=r(29260),i=r(53861),o=r(56455),l=r(19620),c=r(85454),u=r(69850);async function*d(e){yield*p(h(e))}async function*p(e){let t=null;for await(let r of e)if(!r.startsWith(":")){if(r.startsWith("event:")){t&&l.logging.error("received_sse_event_without_data",{event_type:t}),t=r.slice(6).trim();continue}if(r.startsWith("data:")){let e=r.slice(5).trimStart();try{yield{type:t,data:JSON.parse(e)}}catch(r){l.logging.error("failed_to_parse_sse_event",{error:r,event_type:t,event_data:e})}t=null}}}async function*h(e){let t=new TextDecoder,r="";for(;;){let{done:a,value:s}=await e.read(),n=(r+=t.decode(s,{stream:!a})).split(/\n+/);for(let e of(r=n.pop()||"",n))yield e;if(a){r&&(yield r);break}}}var g=r(24500),f=r(86912),m=r(83473),w=r(75281),v=r(74575),y=r(86349);let E=[/^\/user/,/^\/auth/,/^\/public/,/^\/health/];function b(e,t){let r={...e&&{Authorization:"Bearer ".concat(e)},"X-Client-Git-SHA":"d4842be734964a6d6a1841b87b93ef403a6d810d"};return(0,w.uy)({baseURL:t,headers:r,withCredentials:!0})}class R{getBaseURL(){return(0,f.N)()}assertEndpointAccess(e){var t;if(t=e,!(!o.dA.getState().active||E.some(e=>e.test(t)))){let e=o.dA.getState();if(e.active)throw new g.L("sso_reauth_required",e.message||"SSO Session Expired");throw new g.L("access_denied","Access to this endpoint is restricted")}}async getApi(){if(!i.tokenManager.isInitialized())return await new Promise(e=>setTimeout(e,50)),this.getApi();let e=await i.tokenManager.getValidToken();e||(0,v.v)("Tried to get API with no valid ID token",{error:Error("Tried to get API with no valid ID token"),severity:c.$.ERROR});let t=b(e,this.getBaseURL()),r=e=>{if(null==e?void 0:e.headers.get("Lovable-Cachebuster")){let e=new CustomEvent("lovable-cachebuster");document.dispatchEvent(e)}};return t.setResponseHandler((e,t)=>(r(t),e)),t.setErrorHandler((e,t)=>{if(r(t),e&&"object"==typeof e&&"status"in e){if(401===e.status){let e=window.location.pathname;n.authEvents.emitAuthError(e)}403===e.status&&s.queryClient.invalidateQueries({queryKey:u.QO.all})}return Promise.reject((0,m.yO)(e))}),t}async get(e,t){return this.assertEndpointAccess(e),(await this.getApi()).get(e,t)}async delete(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).delete(e,t,r)}async post(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).post(e,t,r)}async put(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).put(e,t,r)}async patch(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).patch(e,t,r)}async head(e,t){return this.assertEndpointAccess(e),(await this.getApi()).head(e,t)}async getWithStreaming(e){let{url:t,onMessage:r,params:a,signal:s,reconnectOptions:n}=e,c=o.dA.getState();if(c.active)throw new g.L("sso_reauth_required",c.message||"SSO Session Expired");let u={initialDelayMs:1e3,maxDelayMs:1e4,backoffFactor:2,retryCount:10,...n},p=0,h=async()=>{try{let e=await i.tokenManager.getValidToken(),n="".concat(this.getBaseURL()).concat(t);if(a&&Object.keys(a).length>0){let e=new URLSearchParams(a).toString();n+=(t.includes("?")?"&":"?")+e}let o=await fetch(n,{method:"GET",headers:{...e?{Authorization:"Bearer ".concat(e)}:{},Accept:"text/event-stream",Connection:"keep-alive","Cache-Control":"no-cache"},signal:s}),c=o.headers.get("X-Trace-Id")||void 0;if(!o.ok){let e;try{let t=await o.text(),r=o.headers.get("Content-Type")||"";if(r.includes("application/json"))try{e=JSON.parse(t)}catch(a){l.logging.error("failed_to_parse_json_response",{error:a,responseText:t,contentType:r}),e=t}else l.logging.debug("non_json_error_response",{contentType:r,responseText:t}),e=t}catch(e){l.logging.error("failed_to_parse_response_body",{error:e,status:o.status,contentType:o.headers.get("Content-Type")})}if(429===o.status)throw new y.o("We are currently under heavy load, please try again later.",429,"RATE_LIMIT_EXCEEDED",e,c);throw new y.o("Request failed",o.status,o.statusText,e,c)}let u=o.body.getReader();try{for await(let e of d(u))if("error"===e.type)throw function(e,t){var r;let a=k.safeParse(e.data);if(!a.success)return l.logging.error("failed_to_parse_server_sse_error",{parse_error:a.error,event_data:e.data,traceId:t}),new g.L(m.i4.malformed,"Failed to parse server SSE error",void 0,500,t);let s=a.data,n=null!=(r=s.traceId)?r:t;return"Request cancelled"===s.message?new y.o("Request cancelled",499,"REQUEST_CANCELLED",s,n):(l.logging.error("server_sse_error",{error:s,traceId:n}),new y.o(s.message,500,s.type,s,n))}(e,c);else try{r(e)}catch(e){l.logging.error("unhandled_error_in_message_handler",{error:e})}}catch(e){if(await u.cancel().catch(()=>{}),e instanceof Error&&"AbortError"===e.name)return;if(e instanceof y.o){if(499===e.status)return void l.logging.info("stream_connection_cancelled",{url:t});throw e}throw l.logging.error("unexpected_error_during_sse",{error:e}),e}finally{u.releaseLock()}}catch(a){var e;if(a instanceof Error&&"AbortError"===a.name)return void l.logging.info("stream_connection_aborted",{url:t});if(a instanceof y.o&&"Request cancelled"===a.message)return void l.logging.info("stream_connection_cancelled",{url:t});if(a instanceof y.o&&"RATE_LIMIT_EXCEEDED"===a.statusText)throw a;if(p>=u.retryCount)throw l.logging.error("stream_connection_max_retries_exceeded",{url:t,maxRetries:u.retryCount,error:a}),a;let r=Math.min(u.initialDelayMs*Math.pow(u.backoffFactor,p),u.maxDelayMs);return l.logging.info("stream_connection_retry",{url:t,retryCount:p+1,maxRetries:u.retryCount,delayMs:r,error:a}),await new Promise(e=>setTimeout(e,r)),p++,null==n||null==(e=n.onReconnect)||e.call(n),h()}};return h()}constructor(){}}let k=a.Ik({type:a.Yj(),message:a.Yj(),details:a.Yj(),traceId:a.Yj().optional()}),A=new R;function _(){return A}function S(){return b(null,(0,f.N)())}},69850:(e,t,r)=>{r.d(t,{QO:()=>a,a$:()=>o,cm:()=>i,gO:()=>s,mp:()=>l,ns:()=>c,workspaceKeys:()=>n});let a={all:["permissions"],get:(e,t)=>[...a.all,e,t]},s={all:["projects"],details:()=>[...s.all,"detail"],detail:e=>[...s.details(),e],sharedWithMe:()=>[...s.all,"shared"],pendingProjectInvites:()=>[...s.all,"pending-invites"],accessRequests:e=>[...s.detail(e),"access-requests"],branches:e=>[...s.detail(e),"branches"],secretLinkId:e=>[...s.detail(e),"secret-link-id"],domains:e=>[...s.detail(e),"domains"],sourceCode:(e,t)=>[...s.detail(e),"source-code",t],commitDiff:(e,t)=>[...s.detail(e),"commit-diff",t],feedbackStatus:e=>[...s.detail(e),"feedback-status"],presence:e=>[...s.detail(e),"presence"],communityProjects:(e,t,r,a)=>[...s.all,"community",e,t,r,a],userProjects:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"updated_at",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"desc",n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return[...s.all,"user-projects",e,t,r,a,n,i]},collaborators:e=>[...s.detail(e),"collaborators"],analytics:(e,t)=>[...s.detail(e),"analytics",t],analyticsTrend:e=>[...s.detail(e),"analytics-trend"],projectDetails:e=>[...s.detail(e),"details"],initialPrompt:e=>[...s.detail(e),"initial-prompt"],integrations:e=>[...s.detail(e),"integrations"],integration:(e,t)=>[...s.integrations(e),t]},n={all:["workspaces"],totalProjects:e=>[...n.all,e,"total-projects"],projects:e=>{let{workspaceId:t,userId:r,limit:a,isDraft:s=!1}=e;return[...n.detail(t),"projects",r,a,s?"draft":"published"]},membership:(e,t)=>[...n.all,e,"membership",t],memberships:(e,t)=>{var r;return t?[...n.detail(e),"memberships",(null==t?void 0:t.query)||"",(null==t?void 0:t.status)||"all",(null==t||null==(r=t.roles)?void 0:r.join(","))||"",(null==t?void 0:t.limit)||20,(null==t?void 0:t.offset)||0,(null==t?void 0:t.sortBy)||"joined_at",(null==t?void 0:t.sortOrder)||"desc"]:[...n.detail(e),"memberships"]},detail:e=>[...n.all,e],supabaseOrganizations:(e,t)=>[...n.all,e,"supabase-organizations",t],pendingWorkspaceInvites:()=>[...n.all,"unaccepted-invites"],projectAccessRequests:e=>[...n.detail(e),"project-access-requests"],inviteUser:(e,t)=>[...n.all,e,"invite-user",t],workspaceRole:(e,t)=>[...n.all,e,"workspace-role",t],workspaceUsage:(e,t,r)=>[...n.all,e,"workspace-usage",t,r],workspaceUserTotalUsage:e=>[...n.all,e,"workspace-user-total-usage"],workspaceGithubInstallations:e=>[...n.all,e,"workspace-github-installations"],referralCode:(e,t)=>[...n.all,e,"referral-code",t],referralCodeUsage:e=>[...n.all,e,"referral-code-usage"],workspaces:e=>{let{userId:t}=e;return[...n.all,t,"workspaces"]},templates:e=>[...n.detail(e),"templates"],integrationsOAuthStatus:(e,t)=>[...n.detail(e),"integrations",{integrations:t}],integrationOAuthStatus:(e,t)=>[...n.detail(e),"integrations",t,"oauth"],workspaceLovableCloudUsage:e=>[...n.all,e,"workspace-lovable-cloud-usage"],lovableCloudProjectUsageBreakdown:(e,t,r)=>[...n.all,e,"lovable-cloud-project-usage-breakdown",{limit:t,startAfter:r}],builderCount:e=>[...n.detail(e),"builder-count"],autoTopup:e=>[...n.detail(e),"auto-topup"]},i={all:["github"],installations:()=>[...i.all,"installations"],repoAccessibility:e=>[...i.all,"repo-accessibility",e],repos:e=>[...i.all,"repos",null==e?void 0:e.account.login,null==e?void 0:e.target_type]},o={all:["users"],experimentalFeatures:()=>[...o.all,"experimental-features"],workspaces:()=>[...o.all,"workspaces"],workspace:e=>[...o.workspaces(),e],profile:e=>[...o.all,e],contributions:e=>[...o.all,"contributions",e],studentDomains:()=>[...o.all,"student-domains"],toolApprovalPreferences:()=>[...o.all,"preferences","tool-preferences"]},l={all:["cloud"],details:()=>[...l.all,"details"],detail:e=>[...l.details(),e],status:()=>[...l.details(),"status"],compute:()=>[...l.details(),"compute"],secrets:()=>[...l.details(),"secrets"]},c={all:["templates"],remixCount:e=>[...c.all,"remix-count",e]}},74575:(e,t,r)=>{r.d(t,{V:()=>i,v:()=>o});var a=r(19620),s=r(85454);let n={[s.$.ERROR]:"error",[s.$.WARN]:"warn",[s.$.INFO]:"info",[s.$.DEBUG]:"debug",[s.$.TRACE]:"trace",[s.$.LOG]:"log"};function i(e){let{error:t,severity:r,context:i}=e,o=n[r],l="api_error_".concat(t.type);a.logging[o](l,{error:t}),(r===s.$.ERROR||r===s.$.WARN)&&o11y.captureException(Error("API Error: ".concat(t.type)),{type:l,context:i})}function o(e,t){let{error:r,severity:i,context:o}=t,l="".concat(e,": ").concat(r instanceof Error?r.message:"Weird error"),c=r instanceof Error?r:Error(l),u=n[i];a.logging[u](l,{...o,error:r}),(i===s.$.ERROR||i===s.$.WARN)&&(c.message=l,o11y.captureException(c,{level:i===s.$.ERROR?"error":"warning",context:{...o,weird_error:r instanceof Error?void 0:r}}))}},75281:(e,t,r)=>{function a(e){return e instanceof Error&&"number"==typeof e.status&&"data"in e&&"string"==typeof e.httpMethod}r.d(t,{NF:()=>a,uy:()=>n});class s{setResponseHandler(e){this.responseHandler=e}setErrorHandler(e){this.errorHandler=e}createUrl(e,t){let r=new URL("".concat(this.baseURL).concat(e));return t&&Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&r.searchParams.append(t,a)}),r.toString()}createRequestOptions(e,t,r){let a={...this.defaultHeaders,...(null==t?void 0:t.headers)||{}};r instanceof FormData||(a["Content-Type"]="application/json");let s={method:e,headers:a,credentials:this.withCredentials?"include":"same-origin",signal:null==t?void 0:t.signal};return void 0===r||["GET","HEAD"].includes(e)||(r instanceof FormData?s.body=r:s.body=JSON.stringify(r)),s}async processResponse(e,t){return this.responseHandler?await this.responseHandler(e,t):e}async processError(e,t){throw this.errorHandler&&(e=await this.errorHandler(e,t)),e}async request(e,t,r,a){try{let s=this.createUrl(t,null==r?void 0:r.params),n=this.createRequestOptions(e,r,a),i=await fetch(s,n);if(!i.ok){let t=Error("Request failed with status ".concat(i.status));t.response=i,t.status=i.status,t.statusText=i.statusText,t.httpMethod=e;let r=i.clone();try{t.data=await r.json()}catch(e){t.data=await i.text()}return this.processError(t,i)}if(204===i.status||"0"===i.headers.get("Content-Length"))return this.processResponse({},i);let o=await i.json();return this.processResponse(o,i)}catch(e){return this.processError(e)}}async get(e,t){return this.request("GET",e,t)}async delete(e,t,r){return this.request("DELETE",e,r,t)}async head(e,t){return this.request("HEAD",e,t)}async post(e,t,r){return this.request("POST",e,r,t)}async postMultipart(e,t,r){return this.request("POST",e,r,t)}async put(e,t,r){return this.request("PUT",e,r,t)}async patch(e,t,r){return this.request("PATCH",e,r,t)}constructor(e,t={},r=!1){this.responseHandler=null,this.errorHandler=null,this.baseURL=e,this.defaultHeaders=t,this.withCredentials=r}}function n(e){return new s(e.baseURL,e.headers,e.withCredentials)}},77817:(e,t,r)=>{r.d(t,{C:()=>a});let a="production"===(r(40074).env.NEXT_PUBLIC_NODE_ENV||"production")?{apiKey:"AIzaSyBQNjlw9Vp4tP4VVeANzyPJnqbG2wLbYPw",authDomain:"auth.lovable.dev",projectId:"gpt-engineer-390607",storageBucket:"gpt-engineer-390607.appspot.com",messagingSenderId:"288002387414",appId:"1:288002387414:web:231da37c38c486ca814877",measurementId:"G-EFZ8TB5QLN",clientEmail:"firebase-adminsdk-thfj5@gpt-engineer-390607.iam.gserviceaccount.com"}:{apiKey:"AIzaSyC8MAnZTLUBttWHlEIMl0u8gGI0R5oGnXU",authDomain:"gpt-engineer-dev.firebaseapp.com",projectId:"gpt-engineer-dev",storageBucket:"gpt-engineer-dev.appspot.com",messagingSenderId:"435422046193",appId:"1:435422046193:web:36e2c4049799e14110c650",clientEmail:"firebase-adminsdk-tg5bc@gpt-engineer-dev.iam.gserviceaccount.com"}},83473:(e,t,r)=>{r.d(t,{Ni:()=>h,i4:()=>u,yO:()=>p});var a=r(31088),s=r(82694),n=r(56455),i=r(85454),o=r(24500),l=r(75281),c=r(74575);let u={network:"network_error",malformed:"malformed_response"},d=s.Ik({type:s.Yj(),message:s.Yj().optional().transform(e=>e||void 0),details:s.Yj().optional().transform(e=>e||void 0)});function p(e){if((0,l.NF)(e)){var t,r,a;let s={url:null==(t=e.response)?void 0:t.url,method:e.httpMethod,status:e.status},l=(null==(a=e.response)||null==(r=a.headers)?void 0:r.get("X-Trace-Id"))||void 0;if(!e.response)return(0,c.v)("Network error",{error:e,severity:i.$.INFO,context:s}),new o.L(u.network,"Connection Error","Please check your internet connection");let p=e.data,h=d.safeParse(p);if(h.success){let t=new o.L(h.data.type,h.data.message||"",h.data.details,e.status,l);if((0,c.V)({error:t,severity:i.$.INFO,context:s}),"sso_reauth_required"===t.type)try{let e=p.props||{},r=Array.isArray(e.providers)?e.providers:[],a=e.workspace;a&&r.length>0&&(0,n.fJ)({message:t.message,providers:r,workspace:a})}catch(e){(0,c.v)("Failed to start SSO reauth flow",{error:e,severity:i.$.ERROR})}return t}return(0,c.v)("Bad error from backend",{error:e,severity:i.$.ERROR,context:{...s,error_data:p,response:e.response,zodError:h.error}}),new o.L(u.malformed,e.statusText||"",void 0,e.status,l)}return e instanceof TypeError&&/network|failed to fetch/i.test(e.message)?((0,c.v)("Native network error",{error:e,severity:i.$.INFO}),new o.L(u.network,"Connection Error","Please check your internet connection")):((0,c.v)("Unhandled error type",{error:e,severity:i.$.ERROR}),new o.L(u.malformed,""))}function h(e){e instanceof o.L?(a.toast.error(e.message||"Something went wrong",{duration:8e3,description:e.details}),e.message||(0,c.v)("User sees vague api error",{error:e,severity:i.$.ERROR})):(a.toast.error("Something went wrong",{description:"Lovable has been notified.",duration:8e3}),(0,c.v)("User sees vague error",{error:e,severity:i.$.ERROR}))}},85454:(e,t,r)=>{r.d(t,{$:()=>a});var a=function(e){return e.LOG="LOG",e.TRACE="TRACE",e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({})},86349:(e,t,r)=>{r.d(t,{o:()=>a});class a extends Error{constructor(e,t,r,a,s){super(e),this.status=t,this.statusText=r,this.response=a,this.traceId=s}}},86912:(e,t,r)=>{r.d(t,{N:()=>n});var a=r(92912),s=r(680);let n=()=>{try{var e;if((null==(e=a.Ay.isFeatureEnabled)?void 0:e.call(a.Ay,s.x.GkeApiUrl))&&1)return"https://api.lovable.dev"}catch(e){}return"https://lovable-api.com"}}}]);